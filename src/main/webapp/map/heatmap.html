<html>
<head>
  <meta charset="utf-8">
</head>
<body style="width: 100%; height: 100%; min-height: 100%;">
  <div id="map" style="width: 100%; height: 100%; min-height: 100%;"></div>
  <script src="scripts/modestmaps.min.js"></script>
  <script>
    var baselayer = new MM.TemplatedLayer('http://c.tiles.mapbox.com/v3/timrobertson100.map-x2mlizjd/{Z}/{X}/{Y}.png');
    var map = new MM.Map("map", baselayer, null, [
      MM.DragHandler(),
      MM.DoubleClickHandler(),
      MM.MouseWheelHandler().precise(true),
      MM.TouchHandler()
    ]);
    map.setCenterZoom(new MM.Location(0,0), 1);
    //map.insertLayerAt(1, new MM.TemplatedLayer('/map/occurrence/occurrence.png?x={X}&y={Y}&z={Z}' +
    //                                           window.location.href.slice(window.location.href.indexOf('?') + 1)));
    var params = '';
    if (window.location.href.indexOf('?') > 1) {
      params = '&' + window.location.href.slice(window.location.href.indexOf('?') + 1);
    }
    map.insertLayerAt(1, new MM.TemplatedLayer('/map/occurrence/occurrence.png?x={X}&y={Y}&z={Z}' + params));
  </script>
</body>
</html>
